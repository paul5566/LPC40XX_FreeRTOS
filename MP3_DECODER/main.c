#include <stdio.h>
#include <string.h>

#include "FreeRTOS.h"
#include "task.h"

#include "board_io.h"
#include "common_macros.h"
#include "gpio.h"
#include "sj2_cli.h"

#include "ff.h"
#include "cli_handlers.h"

#include "lcd.h"
#include "gpio_isr.h"
#include "ssp2_lab.h"

uint8_t sound_test_mp3[]={0x0, 0x0, 0xff, 0xfb, 0xb0, 0x64, 0x0, 0xf, 0xf0, 0x0, 0x0, 0x69, 0x0, 0x0, 0x0, 0x8, 0x0, 0x0, 0xd, 0x20, 0x0, 0x0, 0x1, 0x0, 0xc, 0x2, 0x0, 0x0, 0x80, 0x0, 0x20, 0x4, 0x80, 0x40, 0x0, 0x90, 0x0, 0x4, 0x62, 0x64, 0xc4, 0x14, 0xd4, 0x53, 0x32, 0xe3, 0x93, 0x92, 0xe3, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55,0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x0, 0x20, 0x94, 0x93, 0x6e, 0x10, 0x44, 0x1d, 0x70, 0xec, 0x8, 0x88, 0x44, 0x0, 0x11, 0x1, 0x85, 0x93, 0x1, 0xac, 0x6, 0x99, 0xeb, 0x4, 0x55, 0xb6, 0x89, 0x8, 0x89, 0x64, 0xf8, 0xf, 0x28, 0xb1, 0x61, 0x9a, 0xb3, 0x83, 0xc3, 0xb2, 0x7a, 0x11, 0x61, 0x85, 0x7c, 0x4b, 0x2d, 0x9c, 0x13, 0x12, 0x93, 0xee, 0xb0, 0xe0, 0x48, 0x30, 0x3c, 0xe2, 0xe0, 0x34, 0x5a, 0x4, 0x10, 0x4, 0x34, 0x18, 0x89, 0xf3, 0x4c, 0xd3, 0x66, 0x2e, 0x6c, 0xc7, 0x21, 0xa0, 0x84, 0x4b, 0x9, 0x38, 0xa0, 0x43, 0xcd, 0x33, 0x4d, 0x56, 0x7e,0x23, 0x1f, 0xb6, 0x1a, 0x5, 0xcd, 0xa4, 0xe4, 0x68, 0x39, 0xcd, 0x33, 0xae, 0x33, 0xd2, 0xd8, 0x74, 0x17, 0xc2, 0x58, 0x91, 0x27, 0x64, 0xed, 0x57, 0x45, 0x21, 0x28, 0x38, 0xd, 0xf3, 0x2d, 0xcc, 0x9e, 0x12, 0xc4, 0x30, 0xde, 0x6, 0xe2, 0x1a, 0x5c, 0xcb, 0xf9, 0xb, 0x57, 0x13, 0x83, 0x21, 0x56, 0xd8, 0x5b, 0x16, 0x4d, 0x35, 0xe3, 0x41, 0x50, 0xa7, 0x21, 0xa, 0xd2, 0x76, 0xd2, 0x9c, 0x1b, 0x82, 0x60, 0x8c, 0x53, 0x90, 0x42, 0xc0, 0x6f, 0x99, 0x67, 0xf9, 0xc6, 0x72, 0x32, 0xa1, 0xee, 0xa3, 0xae, 0x6, 0xe1, 0x2c, 0x5f, 0x42, 0xed, 0x9d, 0x29, 0xcb, 0x79, 0x2f, 0x3d, 0xc, 0x84, 0xe1, 0x70, 0x5f, 0x10, 0xc3, 0x94, 0x4c, 0xd3, 0xca, 0xd0, 0xbf, 0xc, 0x35, 0x11, 0xd1, 0x88, 0x7b, 0x52, 0xd, 0xc1, 0x70, 0x44, 0x8b, 0x9b, 0x10, 0x85, 0x86, 0xac, 0x5c, 0xd4, 0x42, 0xd8, 0x78, 0x5e, 0x52, 0xde, 0x1a, 0x83, 0x10, 0x7d, 0x97, 0xb2, 0x78, 0x3f, 0x5, 0x9c, 0x23, 0x6e, 0xf3, 0x1c, 0x56, 0xaf, 0xc8, 0x10, 0x20, 0x10, 0x59, 0x3a, 0x4, 0x44, 0x22, 0x8, 0x48, 0x3a, 0x64, 0x11, 0x58, 0xd, 0x66, 0x20, 0x78, 0x59, 0xc1, 0x12, 0x8, 0xa2, 0x76, 0xe, 0xb0, 0x42, 0x5, 0x8c, 0x6d, 0x7a, 0xf3, 0xb3, 0x34, 0xc2, 0x43, 0xa4, 0x88, 0x8e, 0xcf, 0xce, 0x9, 0x8c, 0x9f, 0xdd, 0xc6, 0xcc, 0xcc, 0xde, 0x30, 0x71, 0xb3, 0x31, 0x21, 0x41, 0xda, 0xb2, 0xa1, 0x30, 0xbe, 0xd, 0xd7, 0x3, 0x77, 0x89, 0x0, 0xd0, 0x48, 0x12, 0x4, 0x82, 0xc5, 0x61, 0x25, 0x89, 0x65, 0xb2, 0xa1, 0x60, 0xec, 0x4b, 0x5c, 0x5b, 0x24, 0x13, 0x22, 0x25, 0x83, 0x71, 0x2c, 0xcc, 0xcc, 0xb1, 0xb, 0x42, 0x40, 0x88, 0x4c, 0x2f, 0x93, 0xd2, 0x3, 0x71, 0x1c, 0xcc, 0x96, 0x4f, 0x8c, 0xe0, 0x48, 0x64, 0xb0, 0x57, 0x1d, 0xda, 0x5a, 0x13, 0x81, 0x33, 0xe1, 0x20, 0xfd, 0xa0, 0x40, 0xd4, 0x47, 0x29, 0x1e, 0x83, 0x75, 0x42, 0x18, 0x13, 0x6, 0xe6, 0xe1, 0x21, 0x41, 0x58, 0x48, 0x6a, 0x0, 0x81, 0x41, 0xe4, 0x21, 0x38, 0xfe, 0x20, 0x15, 0x50, 0x40, 0x9a, 0xa2, 0x40, 0x20, 0x4, 0x7, 0xc1, 0xec, 0x77, 0x9a, 0x92, 0xc4, 0x31, 0x1c, 0x80, 0x14, 0x14, 0xc1, 0xb8, 0x37, 0x28, 0x1f, 0x84, 0x83, 0xe1, 0x5c, 0x13, 0x3, 0xe7, 0xc7, 0x99, 0xbe, 0x90, 0x98, 0x43, 0x2, 0x62, 0x3a, 0xe0, 0x4c, 0x0, 0xc7, 0xf2, 0xa1, 0xe2, 0x75, 0x40, 0x81, 0xe8, 0x2, 0xe, 0x9d, 0x7b, 0x9d, 0x80, 0xb0, 0x1f, 0x1c, 0x72, 0x0, 0x1b, 0x80, 0x5c, 0x56, 0x85, 0xd8, 0x13, 0x8b, 0x21, 0xd6, 0x20, 0xe4, 0x44, 0x0, 0xc3, 0x19, 0x28, 0xe0, 0x35, 0x4, 0xf4, 0xae, 0x5, 0x80, 0x93, 0x82, 0xfd, 0x76, 0x5b, 0x87, 0xad, 0x52, 0x40, 0x45, 0x2c, 0xfa, 0x14, 0xc1, 0x52, 0x26, 0x6, 0x7a, 0x7, 0xa0, 0x2e, 0x4e, 0xc3, 0xd2, 0xa1, 0x71, 0xba, 0xd, 0xb3, 0x2d, 0xb2, 0x90, 0x8c, 0x29, 0xab, 0x2a, 0x82, 0xff, 0xfb, 0xb2, 0x64, 0xff, 0x88, 0xc7, 0x56, 0x68, 0xa9, 0xb8, 0xcc, 0x7c, 0xc0, 0xd5, 0xcc, 0xf5, 0x42, 0x18, 0xcc, 0x3e, 0x63, 0x45, 0x9e, 0xa6, 0x7, 0xe1, 0xf5, 0x8c, 0x40, 0xb3, 0xd5, 0x4, 0xf7, 0xbd, 0xb9, 0x97, 0x23, 0x42, 0x89, 0xb1, 0x74, 0x7, 0xd6, 0x67, 0x2b, 0xc2, 0x2e, 0xf4, 0x24, 0x82, 0xc3, 0xcd, 0xa1, 0xba, 0x20, 0x41, 0xc9, 0x16, 0x9d, 0xea, 0xb1, 0xbb, 0xbb, 0xab, 0xd9, 0xb1, 0xbf, 0xd, 0xc5, 0xa9, 0x22, 0x2, 0xc7, 0x46, 0xb5, 0x12, 0x5c, 0xa, 0x67, 0x11, 0x64, 0xd0, 0x3, 0x13, 0x62, 0x30, 0xfa, 0xec, 0x80, 0xcb, 0xf6, 0x88, 0x6d, 0x7c, 0xbd, 0x6a, 0x38, 0x9c, 0x6c, 0x22, 0x1a, 0x5b, 0xb4, 0xab, 0x91, 0xe9, 0x4c, 0xf4, 0xcb, 0x6f, 0x4b, 0xe6, 0x92, 0x8b, 0x51, 0xa, 0x14, 0xed, 0x3c, 0xd4, 0x32, 0xa3, 0x16, 0x8e, 0x34, 0xb8, 0x65, 0x6f, 0xa3, 0x24, 0x25, 0x15, 0xe0, 0xc4, 0x83, 0x35, 0xc5, 0xcc, 0xc5, 0x1b, 0xf1, 0x45, 0x5e, 0xc7, 0x3a, 0x44, 0x22, 0xc6, 0x40, 0x64, 0x1, 0x0, 0x80, 0x7, 0x81, 0x17, 0x86, 0xa2, 0x18, 0xa7, 0xa3, 0x18,0x34, 0xc2, 0x80, 0x2d, 0x2, 0x50, 0x4e, 0xca, 0xd0, 0x61, 0x89, 0x18, 0x7b, 0x5f, 0x2a, 0xc, 0x73, 0x14, 0xa0, 0x6a, 0x9, 0x40, 0x6c, 0x15, 0xa0, 0x3b, 0x8e, 0xf0, 0x9b, 0x7, 0xc1, 0xca, 0xb, 0xc0, 0xdb, 0x5b, 0x88, 0x3a, 0x8b, 0xad, 0xc0, 0x9f, 0x1c, 0xe1, 0x38, 0x24, 0x67, 0x38, 0x45, 0x89, 0xda, 0x38, 0xc8, 0x3c, 0x8c, 0x1c, 0x87, 0x59, 0x2, 0x71, 0xa, 0xf2, 0xa0, 0x15, 0x80, 0x36, 0x3a, 0xd, 0x3, 0xdc, 0xea, 0x9c, 0x23, 0x64, 0x4, 0xe3, 0x1e, 0x4, 0x64, 0xc5, 0x5, 0x98, 0x9f, 0x84, 0xd8, 0xa6, 0x1e, 0x0, 0xb4, 0x2, 0x71, 0x60, 0x44, 0x0, 0x50, 0x10, 0xc1, 0x33, 0x36, 0x3, 0x20, 0x18, 0xe, 0x23, 0x1c, 0x69, 0x95, 0x90, 0x4, 0xcc, 0xa1, 0x4b, 0x4, 0x0, 0x90, 0x9, 0x40, 0xcc, 0x16, 0xf0, 0xdf, 0x23, 0x7, 0x80, 0x68, 0x41, 0x27, 0xc7, 0xfa, 0x68, 0x8c, 0x11, 0xc2, 0xe1, 0x0, 0xd, 0x0, 0x26, 0xa, 0xc1, 0xf6, 0x41, 0x45, 0xa4, 0xbe, 0x8, 0xf9, 0xad, 0x71, 0x8, 0x28, 0x8d, 0x50, 0x93, 0x8f, 0x40, 0x64, 0xf, 0x73, 0x1c, 0x2b, 0xe1, 0x17, 0x12, 0x78, 0xab, 0x48, 0x6, 0x40, 0x70, 0x17, 0x51, 0x5a, 0x2d, 0xe9, 0x0, 0x68, 0x10, 0x31, 0x98, 0x61, 0xa1, 0xa4, 0xda, 0x10, 0x93, 0x9b, 0xa6, 0xb0, 0x7e, 0x10, 0xb0, 0xbb, 0x1b, 0x4, 0x40, 0xaf, 0x98, 0x4, 0x41, 0x33, 0xa9, 0x61, 0x7e, 0x4e, 0x11, 0x61, 0x2b, 0xb, 0x5a, 0xd0, 0x39, 0x5, 0xd0, 0x67, 0x84, 0x7d, 0x74, 0x56, 0xbd, 0x25, 0x9, 0x91, 0x7e, 0x30, 0x13, 0x2, 0x30, 0x18, 0x86, 0xa8, 0x48, 0xd8, 0x8a, 0x51, 0xc9, 0x65, 0x29, 0xae, 0x2c, 0x88, 0x69, 0x16, 0x22, 0x8b, 0x20, 0xdb, 0x1d, 0xe3, 0x30, 0x2f, 0x14, 0xa4, 0x79, 0x47, 0x1, 0x42, 0x63, 0x13, 0x35, 0xc8, 0x8d, 0x91, 0x81, 0x28, 0xd, 0xc2, 0x80, 0x4a, 0x3, 0x93, 0x44, 0x42, 0x2d, 0x20, 0xc6, 0x1a, 0x62, 0xee, 0x8f, 0x8, 0xd8, 0xbb, 0x9a, 0xa1, 0xf, 0x53, 0xb, 0xc5, 0x29, 0x98, 0x83, 0x3a, 0x4a, 0xa7, 0x3, 0xc8, 0x48, 0xd, 0x50, 0x53, 0xb1, 0xb, 0xc0, 0xb4, 0x1f, 0xa1, 0xb8, 0x2e, 0xeb, 0x71, 0x9, 0xb1, 0xdb, 0x0, 0x39, 0xd, 0x91, 0x28, 0xc, 0x1, 0xc8, 0x25, 0x8, 0xda, 0xd1, 0x90, 0x8e, 0x3b, 0x72, 0x31, 0xca, 0x28, 0xa1, 0xce, 0x46, 0xc8, 0xf0, 0x60, 0x4c, 0x29, 0x7, 0xca, 0x1c, 0xaf, 0x40, 0x11, 0x94, 0xd8, 0x87, 0x95, 0x26, 0x28, 0x40, 0xd0, 0xe0, 0xb8, 0xb, 0x5a, 0x38, 0x34, 0x1, 0x80, 0xe0, 0x21, 0x26, 0x70, 0x26, 0x27, 0x70, 0xaf, 0x44, 0x80, 0xa4, 0x24, 0x70, 0x8b, 0x1e, 0x14, 0x73, 0x68, 0xda, 0x49, 0x50, 0xbe, 0xb0, 0x23, 0x99, 0x1a, 0x1, 0xcc, 0x68, 0x83, 0xb, 0x94, 0x1f, 0x10, 0x2e, 0x6f, 0x4a, 0x88, 0xe6, 0x91, 0x41, 0xc2, 0xba, 0x61, 0x71, 0xe3, 0x93, 0x40, 0x54, 0xdc, 0x30, 0x9f, 0x4e, 0x91, 0xaa, 0x5c, 0x50, 0xc, 0x45, 0x41,0x6, 0x36, 0x8d, 0xa5, 0x17, 0x1b, 0x69, 0x52, 0x32, 0x70, 0xf2, 0x1, 0xc5, 0x5a, 0x20, 0xb5, 0x88, 0xd, 0xeb, 0x63, 0xf4, 0x4a, 0xb8, 0xbb, 0x28, 0x9, 0x29, 0xc8, 0x18, 0xa2, 0xd0, 0x9b, 0xd1, 0xc8, 0xf9, 0x79, 0xb3, 0xb1, 0x82, 0x1, 0x42, 0xff, 0xfb, 0xb2, 0x44, 0x31, 0x83, 0x5, 0x56, 0x67, 0x31, 0x81, 0x26, 0x49, 0xa2, 0xa8, 0x4c, 0xc5, 0xe5, 0x31, 0x2c, 0x5e, 0x52,0x41, 0x9e, 0xe3, 0x3, 0x24, 0xde, 0x82, 0x31, 0x33, 0x1c, 0x64, 0x61, 0x9a, 0xc1, 0x6c, 0xa, 0x18, 0x5a, 0x67, 0xe4, 0xb9,0x3d, 0x23, 0x47, 0xb2, 0x60, 0xcc, 0xcb, 0x10, 0x44, 0x80, 0x29, 0xd0, 0x8a, 0xcd, 0xa8, 0x4a, 0x23, 0x48, 0x84, 0x28, 0x79, 0xb3, 0x2, 0x8b, 0x58, 0x14, 0x32, 0x8c, 0x46, 0x8d, 0x66, 0xcf, 0xeb, 0x93, 0x3c, 0xba, 0x86, 0x13, 0x40, 0x31, 0x14, 0x48, 0xcd, 0x7, 0xc8, 0xc7, 0xe5, 0x31, 0x5c, 0xcd, 0x40, 0x71, 0x75, 0x81, 0x48, 0xd0, 0x81, 0x1b, 0x8, 0xc9, 0xfa, 0x31, 0x38, 0xac, 0x30, 0x4, 0x82, 0x54, 0x5, 0x0, 0xc1, 0x8b, 0x9e, 0x70, 0x5d, 0x2d, 0x9d, 0xbe, 0xfa, 0x99, 0x3e, 0x5, 0x18, 0x41, 0x8a, 0x84, 0x3, 0x3a, 0xb, 0x24, 0x48, 0x8d, 0x1d, 0x2a, 0x18, 0x3c, 0x59, 0xc5, 0x8c, 0x2e, 0xb0, 0xf2, 0x4, 0xdb, 0x81,0x62, 0x62, 0x4c, 0xf0, 0x8a, 0x3a, 0xc1, 0x0, 0x88, 0x52, 0x80, 0xc, 0x10, 0xe8, 0x68, 0xf9, 0xdb, 0xf8, 0xb3, 0x88, 0xb2,0xc3, 0x8c, 0x52, 0x66, 0x91, 0xb, 0x8, 0xa, 0xb0, 0xe2, 0x23, 0x34, 0x6b, 0x19, 0x26, 0x2b, 0x90, 0xb9, 0xcd, 0x6d, 0xf6, 0xc, 0x7, 0x5, 0xab, 0xaf, 0x2, 0x77, 0x48, 0xb1, 0xac, 0x15, 0xf1, 0x2b, 0xa8, 0xb1, 0xcd, 0x29, 0x5c, 0x49, 0x5c, 0x4e, 0xdb, 0x8f, 0x37, 0xbf, 0x5e, 0xf3, 0x33, 0x86, 0xb8, 0x3c, 0xf6, 0xbf, 0x27, 0x67, 0x84, 0x5a, 0x1d, 0xab, 0x64, 0x74, 0xbf, 0xb0, 0xe3, 0x69, 0x46, 0xd3, 0x8b, 0x12, 0x85, 0xb, 0x1c, 0x61, 0xc6, 0xec, 0xb2, 0xa7, 0x63, 0xc5, 0x3c, 0xaa, 0x76, 0x78,0x77, 0x1d, 0x2a, 0xbf, 0x9b, 0x7f, 0x24, 0xa4, 0x6b, 0x34, 0xce, 0xbc, 0x64, 0x6a, 0x50, 0x8b, 0x47, 0xf1, 0x2c, 0x4, 0x25, 0x13, 0xc3, 0x0, 0x11, 0x20, 0xa7, 0x40, 0xc2, 0x69, 0x90, 0x73, 0x2, 0xdc, 0x99, 0x88, 0x10, 0x52, 0x6a, 0x31, 0x15, 0xe1, 0x33, 0xf, 0x2a, 0x42, 0xb, 0xa3, 0x42, 0xfd, 0x98, 0x40, 0x98, 0xf3, 0x1c, 0xc5, 0x2f, 0x9, 0xbd, 0x49, 0x40, 0x3, 0x43, 0xb8, 0x5c, 0x98, 0x5a, 0x6e, 0x3, 0x28, 0xba, 0x26, 0xe4, 0xd8, 0xba, 0x41, 0x32, 0x15, 0x34, 0x43, 0x98, 0x5a, 0x7d, 0x8b,0x7c, 0x75, 0x5, 0xc2, 0xd9, 0x6e, 0x4, 0x66, 0x98, 0x82, 0x9, 0xc4, 0xa1, 0x8b, 0xa5, 0xe7, 0x9a, 0xde, 0xaf, 0x2c, 0x47, 0x4b, 0xb4, 0x6e, 0xc2, 0xeb, 0x32, 0x90, 0x61, 0x3d, 0x48, 0x92, 0x98, 0x46, 0x94, 0x5e, 0xc2, 0x8a, 0xc9, 0x94, 0x78, 0x46, 0x88, 0xc6, 0x0, 0xce, 0x52, 0xc8, 0x39, 0x45, 0xaa, 0xd0, 0x3d, 0xb1, 0x94, 0x4f, 0x4, 0x22, 0x17, 0xa0, 0xe9, 0x20, 0xc9, 0xc3, 0x94, 0xa2, 0x70, 0x5b, 0x25, 0x9a, 0x42, 0x4a, 0x44, 0x2e, 0x8c, 0x94, 0xcb, 0x27, 0x52, 0xc4, 0x1a, 0xf7, 0x36, 0x2c, 0xcc, 0x44, 0x4, 0x81, 0x45, 0x11, 0xb4, 0x98, 0x5a, 0x89, 0x88, 0x20, 0x69, 0xcb, 0x4, 0x52, 0x70, 0x2d, 0x64, 0x30, 0x9b, 0x73, 0xc, 0x92, 0x65, 0x4a, 0x81, 0xd2, 0x40, 0xf2, 0x88, 0x1a, 0x3d, 0x80, 0x15, 0xc5, 0xd3, 0xb1, 0x38, 0x3c, 0xa4, 0xf, 0x4d, 0x9e, 0x9, 0xc3, 0xf3, 0x30, 0xf4, 0xf0, 0x9e, 0xb9, 0x3a, 0x42, 0xe1, 0x22, 0xe, 0xd8, 0xf6, 0xc4, 0x37, 0xd9, 0x44, 0xf, 0xa2, 0xd3, 0x3d, 0x3c, 0x3e, 0x88, 0x44, 0x39, 0x4, 0x22, 0x49, 0xe9, 0xe0, 0x41, 0x6, 0x17, 0xa4, 0x30, 0xfa, 0x94, 0xff, 0x26, 0xd9, 0xa6, 0x16, 0x3d, 0x33, 0x24, 0x9d, 0x46, 0x88, 0x51, 0x7, 0x28, 0x83, 0xdd, 0xdb, 0x13, 0xbb, 0xcf, 0x8, 0x1e, 0x9e, 0x61, 0xf6, 0x4c, 0xac, 0xf0, 0xc4, 0x11, 0x26, 0x54, 0xa6, 0x66, 0x10, 0x3c, 0xe0, 0x89, 0x6c, 0x7, 0x4f, 0x2e, 0xc9, 0xf6, 0xc3, 0x14, 0x11, 0x99, 0xb6, 0x4f, 0x58, 0x82, 0x6c, 0x84, 0x20, 0x78, 0xf9, 0x55, 0x0, 0xe9, 0x46, 0x92, 0x20, 0x6, 0xd1, 0x8a, 0xcb, 0x1, 0x86, 0x2a, 0x22, 0xb2, 0x4b, 0x47, 0x34, 0x6d, 0xa0, 0xcf, 0x9d, 0xb4, 0xd9, 0xca, 0x2c, 0x7d, 0xb7, 0xe1, 0x5e, 0xae, 0x6e, 0xfd, 0x2f, 0x66, 0x1c, 0xdb, 0xd1, 0xb0, 0x38, 0xe9, 0x5c, 0x3, 0xaa, 0x39, 0x3f, 0x5f, 0x43, 0xbc, 0x86, 0xf2, 0xd9, 0xfd, 0xa5, 0x97, 0xd7, 0xaf, 0x9f, 0xe8, 0xf, 0x15, 0xfe, 0x39, 0x74, 0xeb, 0xff, 0xfb, 0xb2,0x44, 0x20, 0x0, 0x4, 0x6f, 0x62, 0xc0, 0xbd, 0x25, 0x80, 0x2, 0x8c, 0xab, 0xe8, 0x19, 0xa4, 0xa4, 0x0, 0x55, 0x25, 0x97, 0x25, 0xb9, 0xa7, 0x80, 0x2, 0xa7, 0x32, 0xa6, 0x37, 0x36, 0xf0, 0x0, 0xef, 0x9f, 0xab, 0xd2, 0x44, 0xbd, 0x7b, 0x7f, 0xee, 0x2f, 0xfb, 0xbf, 0x73, 0xb7, 0xce, 0xc, 0x1c, 0x58, 0x4c, 0xe6, 0x35, 0xa2, 0xde, 0xbc, 0xb3, 0xae, 0xc2, 0xc5, 0x86, 0x6f, 0xd2, 0x6f, 0x3, 0x95, 0xc8, 0xe5, 0xb3, 0xbf, 0xaf, 0xb0, 0x60, 0xf5, 0x29, 0x4d, 0xa5, 0x63, 0x62, 0xdd, 0x7c, 0x72, 0x94,0xa7, 0x74, 0xd2, 0x67, 0x36, 0x66, 0x76, 0xf4, 0xdf, 0xa6, 0x74, 0xf5, 0xe5, 0xbf, 0x9b, 0xfc, 0xe4, 0xfb, 0x15, 0xbc, 0xdf, 0x6f, 0x3b, 0x38, 0xc4, 0x47, 0xe0, 0x0, 0x0, 0x93, 0xdd, 0x40, 0x2, 0x4, 0x90, 0x5d, 0x19, 0x3c, 0xd7, 0x7a, 0x31, 0x5b,0x78, 0xde, 0x29, 0x1d, 0xda, 0xac, 0xd8, 0x4d, 0xb2, 0x36, 0x48, 0xd1, 0x46, 0xdb, 0x84, 0x5, 0x8, 0x81, 0x0, 0xc2, 0x1, 0x41, 0x52, 0x70, 0xb8, 0x88, 0x1b, 0x5d, 0x75, 0x9d, 0xa, 0xbe, 0xba, 0xce, 0xff, 0x4b, 0xac, 0x84, 0x18, 0x9c, 0x17, 0xef, 0xc2, 0x1, 0x42, 0x28, 0x66, 0xc3, 0x31, 0x41, 0x40, 0xac, 0x2e, 0x4e, 0x53, 0x22, 0x8d, 0x1a, 0x8b, 0xb6, 0xbf, 0x94, 0xd3,0x15, 0xb6, 0x50, 0x30, 0x80, 0xc2, 0x6, 0x20, 0x94, 0x4, 0xe9, 0xa2, 0x14, 0x32, 0xbb, 0x50, 0x84, 0xe5, 0xf, 0x3a, 0x86, 0x4b, 0xd4, 0x67, 0x49, 0xea, 0x44, 0x8f, 0x51, 0x5, 0xf8, 0x5b, 0x7f, 0x27, 0xb4, 0x81, 0x44, 0xc, 0x5c, 0x3e, 0x5f, 0xdf, 0xbe, 0xf6, 0xea, 0x7e, 0x1b, 0x9, 0xd6, 0x5a, 0xfb, 0x93, 0xdf, 0xb, 0xa8, 0x67, 0xeb, 0xc5, 0xb2, 0xc6, 0x1, 0xcf, 0xc0, 0x41, 0x4a, 0x5a, 0x53, 0x76, 0x59, 0x2b, 0x4d, 0x16, 0x89, 0x0, 0xa0, 0x8, 0xc3, 0xdd, 0xd4, 0x3, 0x9e, 0xa2, 0x4d, 0xae, 0x1b, 0x57, 0xf6, 0xb, 0x54, 0xa2, 0xb5, 0x31, 0x64, 0x6d, 0xbb, 0xd, 0x58, 0xbb, 0xd1, 0x38, 0x74, 0x76, 0xa5, 0x61, 0xc0, 0xf0, 0x15, 0xc7, 0x4a, 0x4c, 0x56, 0xab, 0xa5, 0x89, 0x7, 0x5d, 0xb, 0x53, 0xb9, 0xae, 0xc, 0xa3, 0x49, 0x4d, 0x88, 0x1b, 0xb5, 0x10, 0xfb, 0x69, 0xe3, 0x62, 0x27, 0x32, 0xa3, 0xa1, 0xdb, 0xe7, 0xef, 0x6f, 0x2d, 0x4a, 0xbb, 0xbb, 0x2e, 0x1d, 0xbf, 0xa5, 0xf5, 0xbb, 0xe7, 0x78, 0xbc, 0x75, 0x7b, 0x3c, 0x7c, 0xdb, 0x4a, 0x28, 0x30, 0xd5, 0xd8, 0x8b, 0x2f, 0xd7, 0xff, 0xff,0xde, 0x44, 0xa6, 0xfe, 0xa3, 0xef, 0x72, 0x45, 0x82, 0xfa, 0x76, 0xeb, 0x69, 0xf7, 0xff, 0xe7, 0xff, 0xf3, 0xf7, 0xe9, 0x34, 0x93, 0x5f, 0x78, 0xcc, 0x77, 0xaf, 0x77, 0x96, 0xda, 0xeb, 0xfc, 0xe7, 0xff, 0xbd, 0xff, 0xff, 0xff, 0xff, 0xb7, 0xef, 0xec, 0xdd, 0x5f, 0x7c, 0x7a, 0xdf, 0x7f, 0x6f, 0xaf, 0x16, 0x34, 0x1a, 0xef, 0x59, 0x6d, 0x92, 0x93, 0xc2, 0x7f, 0xff, 0xff,0xff, 0x4c, 0x85, 0xb4, 0xa2, 0x91, 0xb8, 0x24, 0x52, 0x31, 0xc, 0x88, 0x44, 0x23, 0x9, 0xd5, 0xe1, 0x6b, 0x4c, 0x54, 0x64,0x3c, 0x1, 0xc8, 0xef, 0xa1, 0x1b, 0x5c, 0x2d, 0xd2, 0x98, 0xf7, 0xe4, 0xae, 0xba, 0xc5, 0x77, 0x7e, 0xc1, 0x50, 0x21, 0x95, 0x3f, 0x69, 0x8e, 0x8c, 0xb2, 0xb0, 0xfd, 0x6e, 0x57, 0x63, 0xfe, 0x84, 0x10, 0xb3, 0x2d, 0xce, 0x78, 0x4f, 0x93, 0xd2, 0x6b, 0xff, 0xd, 0x8d, 0x9c, 0xe8, 0x64, 0x3f, 0x55, 0xb8, 0x61, 0x56, 0xff, 0xff, 0xf8, 0x56, 0x30, 0x38, 0x2b, 0xe3, 0xbd, 0x85, 0x1a, 0xf8, 0x7d, 0xed, 0x7f, 0xba, 0x67, 0x4a, 0xf6, 0x79, 0xd9, 0x22, 0x65, 0x9a, 0xd, 0xe1, 0x41, 0x65, 0x83, 0xff, 0xff, 0xff, 0xd5, 0x8f, 0x22, 0x6e, 0x9a, 0x67, 0x67, 0xdd, 0x22, 0xc1, 0x85, 0x1a, 0x15, 0xb1, 0x1b, 0xff, 0xff, 0xff, 0xff, 0xb8, 0x7b, 0x64, 0x79, 0xe8, 0xf2, 0x90, 0xdf, 0xbd, 0xad, 0xb3, 0x2c, 0x19, 0x31, 0x7d, 0xdf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfb, 0xbd, 0xf7, 0x8c, 0xdf, 0x5f, 0xfc, 0xee, 0xef, 0xdf, 0x5f, 0x52, 0x3f, 0x82, 0xe9, 0xaa, 0x78, 0x38, 0xa4, 0xe2, 0x2f, 0xff, 0xdf, 0xff, 0xf3, 0xca, 0xa, 0xbf, 0xc4, 0x0, 0x34, 0x94, 0xc, 0xc6, 0x41, 0x53, 0x8, 0x6, 0xd5, 0x4a, 0x6, 0x54, 0xcd, 0x31, 0xa, 0x53, 0x6a, 0x36, 0xd5, 0x15, 0x52, 0xfa, 0x4c, 0xc3, 0x50, 0x5b, 0xf2, 0xd1, 0x42, 0xff, 0xfb, 0xb2, 0x64, 0x10, 0x81, 0x4, 0xe7, 0x62, 0xc7, 0x47, 0x71, 0x80, 0x2, 0x7c, 0xcc, 0x88, 0xfb, 0xed, 0xa0, 0x0, 0x51, 0x71, 0x93, 0x1f, 0x8e, 0x31, 0xc, 0xc2, 0x48, 0xb3, 0xa4, 0x71, 0x94, 0x9a, 0x18, 0x71, 0x0, 0x15, 0x40, 0x5e, 0xfc, 0x9c, 0x99, 0x24, 0x32, 0xb2, 0xf6, 0x23, 0xb5, 0x3a, 0xb, 0x5e, 0x3a, 0xc4, 0xf3, 0x2e, 0x56, 0xd9, 0x4d, 0xba, 0xf8, 0xaf, 0x36, 0x73, 0x3f, 0x60, 0xb9, 0xed, 0x66, 0x2e, 0xc5, 0xc7, 0xf5, 0xd3, 0x97, 0x3e, 0xf9, 0xb7, 0x89, 0xea, 0x55, 0xae, 0x6b, 0xa3, 0x7b, 0x72, 0xd6, 0x6e, 0xed, 0x3d, 0x5b, 0xc1, 0xd, 0x1b, 0x7b, 0xad, 0x30, 0x64, 0x79, 0x1d, 0xb2, 0xd, 0xce, 0x97, 0x96, 0x75, 0xba, 0xd6, 0xab, 0x1b, 0x96, 0xa3, 0xdf, 0x1c, 0xf9, 0xf4, 0xc0, 0xfb, 0x4d, 0x30, 0xf5, 0x1d, 0xd7, 0x19, 0x6a, 0x7a, 0xf4, 0xca,0x52, 0xd7, 0xbc, 0x1b, 0xaf, 0xd9, 0xea, 0xdd, 0x6d, 0x61, 0xd7, 0x92, 0x65, 0xd6, 0xe1, 0xd7, 0xf3, 0x32, 0xc5, 0xa3, 0x85, 0x6a, 0xb3, 0xf8, 0xf3, 0xde, 0x65, 0x7a, 0xf4, 0x2, 0xae, 0x12, 0xae, 0xaa, 0x11, 0x40, 0x4e, 0x21, 0x28, 0xc2, 0xc2, 0x89, 0x83, 0x93, 0x96, 0xea, 0xc4, 0x5d, 0x6c, 0x5, 0x24, 0x1d, 0x87, 0x8a, 0x7, 0x8b, 0x42, 0xe5, 0xcb, 0x99, 0x95, 0xd8, 0x39, 0xa0, 0xc5, 0x61, 0x82, 0x30, 0x9c, 0x1e, 0x20, 0x7b, 0x8a, 0x10, 0x21, 0x64, 0x14, 0x7d, 0xe2, 0xa8, 0x21, 0x8, 0x49, 0x63, 0xd6, 0xca, 0xa9, 0x83, 0x1e, 0x28, 0x38, 0x1c, 0x89, 0xcf, 0xfc, 0x53, 0xc6, 0x95, 0xc5, 0x4c, 0xcb, 0xd7, 0xf7, 0x15,0xff, 0xf0, 0x88, 0x9f, 0xef, 0xbf, 0xdc, 0xdf, 0x8, 0x89, 0x2f, 0x5b, 0xda, 0x44, 0xdf, 0xa7, 0xfe, 0xf7, 0x71, 0x5f, 0xa7, 0xf, 0x14, 0xfe};
uint8_t sound_test[] = {0xFF, 0xF2, 0x40, 0xC0, 0x19, 0xB7,
                        0x00, 0x14, 0x02, 0xE6, 0x5C, /* ..@.......\ */
                        0x01, 0x92, 0x68, 0x01, 0xF1, 0x5E,
                        0x03, 0x08, 0xF0, 0x24, 0x80, /* ..h..^...$. */
                        0x05, 0x9E, 0x20, 0xC6, 0xFC, 0x12,
                        0x32, 0x5C, 0xBF, 0xF9, 0xB9, /* .. ...2\... */
                        0x20, 0x4A, 0x7F, 0x85, 0xEC, 0x4C,
                        0xCD, 0xC7, 0x27, 0xFE, 0x5C, /*  J...L..'.\ */
                        0x34, 0x25, 0xCB, 0xE6, 0xFF, 0xFF,
                        0x8E, 0x42, 0xE1, 0xA0, 0x5E, /* 4%.....B..^ */
                        0xCA, 0x6E, 0x30, 0x9F, 0xFF, 0xF8,
                        0xC2, 0x12, 0x84, 0xB9, 0x7C, /* .n0.......| */
                        0xDC, 0x61, 0x09, 0x4A, 0x7F, 0xFF,
                        0xFF, 0xF9, 0x7D, 0x32, 0x51, /* .a.J....}2Q */
                        0x09, 0x7C, 0xE1, 0xA5, 0x6E, 0xB4,
                        0xFF, 0xFF, 0xFF, 0xFF, 0xD3, /* .|..n...... */
                        0x34, 0x41, 0x91, 0xF0, 0x11, 0x8F,
                        0x00, 0x0F, 0x81, 0x9C, 0x10, /* 4A......... */
                        0xEE, 0x59, 0xCE, 0x56, 0x67, 0xFF,
                        0xF2, 0x42, 0xC0, 0xEC, 0x53, /* .Y.Vg..B..S */
                        0x09, 0x15, 0xF9, 0xAA, 0xA8, 0x0D,
                        0xD9, 0x40, 0x00, 0xCA, 0x34, /* .......@..4 */
                        0x53, 0xD9, 0x18, 0xAB, 0x7D, 0xF7,
                        0x89, 0x3F, 0x11, 0x38, 0x94, /* S...}..?.8. */
                        0x82, 0x59, 0x93, 0x20, 0x6A, 0x0C,
                        0xEE, 0x8E, 0x58, 0xFA, 0x38, /* .Y. j...X.8 */
                        0x82, 0xCA, 0xF0, 0x58, 0xBB, 0xDA,
                        0x0C, 0x50, 0x56, 0x1F, 0xBB, /* ...X...PV.. */
                        0x18, 0x5D, 0x8B, 0x9F, 0xDA, 0x71,
                        0x4F, 0xFF, 0xBD, 0xFE, 0xEF, /* .]...qO.... */
                        0x69, 0x36, 0x86, 0x3C, 0x50, 0xBB,
                        0x0A, 0x07, 0x89, 0x54, 0xF0, /* i6.<P....T. */
                        0x88, 0x9F, 0x90, 0x95, 0x30, 0x94,
                        0x2E, 0x7E, 0xF0, 0x64, 0x96, /* ....0..~.d. */
                        0x79, 0x08, 0x3E, 0x20, 0x97, 0x28,
                        0x34, 0x9C, 0x09, 0x7F, 0xD2, /* y.> .(4.... */
                        0xC0, 0x01, 0x75, 0xF8, 0x05, 0x6B,
                        0x5F, 0x41, 0x17, 0x0B, 0xE7, /* ..u..k_A... */
                        0xFF, 0xF2, 0x40, 0xC0, 0x61, 0xE5,
                        0x0B, 0x16, 0x09, 0xC6, 0xC5, /* ..@.a...... */
                        0x74, 0x7B, 0xCC, 0x94, 0x7A, 0xF7,
                        0x80, 0x76, 0xB2, 0xD2, 0xF8, /* t{..z..v... */
                        0x39, 0x06, 0x38, 0xFD, 0x71, 0xC5,
                        0xDE, 0x3A, 0x38, 0xBF, 0xD5, /* 9.8.q..:8.. */
                        0xF7, 0x12, 0x37, 0xCB, 0xF5, 0x63,
                        0x0C, 0x9B, 0xCE, 0x77, 0x25, /* ..7..c...w% */
                        0xED, 0xFB, 0x3D, 0x6B, 0x35, 0xF9,
                        0x6D, 0xD7, 0xF9, 0x2C, 0xD1, /* ..=k5.m..,. */
                        0x97, 0x15, 0x87, 0x93, 0xA4, 0x49,
                        0x4A, 0x18, 0x16, 0x07, 0xA1, /* .....IJ.... */
                        0x60, 0xF7, 0x52, 0x94, 0xDB, 0x02,
                        0x16, 0x70, 0xB2, 0xD8, 0x80, /* `.R....p... */
                        0x30, 0xC2, 0x94, 0x40, 0x81, 0x74,
                        0x5A, 0x19, 0x7A, 0x80, 0x60, /* 0..@.tZ.z.` */
                        0x41, 0x21, 0x46, 0x95, 0xD5, 0xC4,
                        0x40, 0xD2, 0x01, 0xC0, 0x01, /* A!F...@.... */
                        0xDA, 0xD9, 0xA0, 0xB1, 0x01, 0xFF,
                        0xF2, 0x42, 0xC0, 0x82, 0x10, /* .......B... */
                        0x0B, 0x12, 0xF9, 0x9E, 0xC9, 0x7E,
                        0x7A, 0xC6, 0x95, 0x55, 0x09, /* .....~z..U. */
                        0x8B, 0x19, 0x5E, 0x8B, 0x26, 0xCA,
                        0xEB, 0x68, 0x8A, 0x05, 0x8F, /* ..^.&..h... */
                        0x36, 0xA5, 0xA5, 0x03, 0xB8, 0x9C,
                        0xED, 0x24, 0x51, 0x59, 0x90, /* 6......$QY. */
                        0xF6, 0xC5, 0x7D, 0xB5, 0xAD, 0xAF,
                        0xF6, 0x3B, 0x18, 0xEF, 0x3F, /* ..}....;..? */
                        0xFF, 0xFF, 0x4E, 0xDE, 0x16, 0x66,
                        0x0B, 0xAA, 0x33, 0x23, 0xDD, /* ..N..f..3#. */
                        0x9C, 0x4E, 0x6E, 0x55, 0x22, 0x9D,
                        0xA2, 0x40, 0xA6, 0x36, 0x31, /* .NnU"..@.61 */
                        0x69, 0xA5, 0xE1, 0xD9, 0x7F, 0xF7,
                        0xC6, 0xCC, 0x48, 0x00, 0x0E, /* i.......H.. */
                        0x90, 0x16, 0x00, 0x0F, 0xDE, 0x6E,
                        0x80, 0x11, 0x0C, 0x9A, 0x4F, /* .....n....O */
                        0x56, 0xDB, 0x88, 0xD3, 0xB2, 0x1C,
                        0x00, 0xE0, 0x2E, 0x3E, 0xAC, /* V........>. */
                        0xFF, 0xF2, 0x40, 0xC0, 0x1C, 0xE5,
                        0x19, 0x13, 0x31, 0x4E, 0xCD, /* ..@.....1N. */
                        0x9E, 0xC3, 0x06, 0x71, 0x03, 0x85,
                        0xE5, 0xB5, 0x6D, 0x88, 0x50, /* ...q....m.P */
                        0x8E, 0x0E, 0x17, 0x3B, 0x19, 0xFB,
                        0x4E, 0x3B, 0x99, 0xEF, 0x4C, /* ...;..N;..L */
                        0x9E, 0xF7, 0x7B, 0x31, 0x7C, 0x3C,
                        0x5F, 0xFF, 0xF4, 0xF8, 0xE3, /* ..{1|<_.... */
                        0x92, 0x42, 0x07, 0x8E, 0x83, 0x8E,
                        0x0F, 0x05, 0x08, 0x91, 0xA3, /* .B......... */
                        0x16, 0xE2, 0xDF, 0xB7, 0x62, 0x60,
                        0x48, 0x31, 0x3C, 0xFF, 0xD4, /* ....b`H1<.. */
                        0x9E, 0x0C, 0x68, 0x00, 0x77, 0x54,
                        0xE3, 0x1E, 0x05, 0xC5, 0xF8, /* ..h.wT..... */
                        0xEA, 0x8D, 0x82, 0x9D, 0x08, 0xA9,
                        0x06, 0x8D, 0x1E, 0x5D, 0x7C, /* .........]| */
                        0x7F, 0x08, 0xC0, 0x50, 0x45, 0x42,
                        0xD0, 0x36, 0xF8, 0xB2, 0x4D, /* ...PEB.6..M */
                        0x53, 0x0C, 0x80, 0x3B, 0x4D, 0xFF,
                        0xF2, 0x42, 0xC0, 0x2F, 0x3C, /* S..;M..B./< */
                        0x25, 0x19, 0x29, 0xFE, 0xBC, 0x2E,
                        0xC4, 0xD0, 0x99, 0x4C, 0x48, /* %.)......LH */
                        0xB0, 0x9C, 0x49, 0xD2, 0x1A, 0x2D,
                        0x02, 0xC2, 0x79, 0x69, 0x16, /* ..I..-..yi. */
                        0x92, 0xA8, 0xC5, 0xAB, 0x45, 0x5A,
                        0x68, 0xE8, 0x75, 0x57, 0xCD, /* ....EZh.uW. */
                        0xF1, 0xB9, 0xAA, 0x13, 0x88, 0xE4,
                        0x87, 0x42, 0x15, 0xB3, 0x58, /* .......B..X */
                        0xF5, 0xA3, 0x46, 0xB1, 0xCF, 0xD3,
                        0x59, 0x7E, 0xBA, 0xB5, 0xA7, /* ..F...Y~... */
                        0x6B, 0x0B, 0x17, 0x57, 0x6B, 0x5C,
                        0x4A, 0xCD, 0x53, 0x76, 0x2A, /* k..Wk\J.Sv* */
                        0x1D, 0x28, 0xC5, 0x1C, 0x76, 0x5C,
                        0xDD, 0x0A, 0x00, 0x4B, 0xC0, /* .(..v\...K. */
                        0x1B, 0xCA, 0xA8, 0xE9, 0x81, 0x5B,
                        0xA6, 0xDC, 0xA4, 0x59, 0x13, /* .....[...Y. */
                        0xFC, 0xBA, 0x8F, 0x98, 0x79, 0x44,
                        0x25, 0xC9, 0x35, 0x38, 0xCA, /* ....yD%.58. */
                        0xFF, 0xF2, 0x40, 0xC0, 0xB9, 0x7D,
                        0x1A, 0x13, 0x79, 0x6A, 0xC8, /* ..@..}..yj. */
                        0x3E, 0xC4, 0x46, 0x94, 0x8D, 0x3C,
                        0x67, 0x85, 0xB1, 0xA8, 0x89, /* >.F..<g.... */
                        0xC0, 0xF2, 0xE6, 0x2F, 0x9D, 0x7C,
                        0xC9, 0xB4, 0xBE, 0xCF, 0xE1, /* .../.|..... */
                        0x7D, 0xFE, 0x1F, 0x03, 0x00, 0x12,
                        0x84, 0x72, 0x8C, 0xE7, 0xD8, /* }......r... */
                        0x5E, 0xC9, 0xA9, 0x01, 0xBA, 0x9B,
                        0xC4, 0x10, 0x5C, 0x70, 0x2E, /* ^.......\p. */
                        0x6C, 0x48, 0xE7, 0x8C, 0x15, 0x0B,
                        0x06, 0x01, 0xE5, 0xFF, 0xFF, /* lH......... */
                        0xD4, 0x0D, 0x00, 0x0F, 0xCE, 0x58,
                        0x95, 0x61, 0xA8, 0x9E, 0x7B, /* .....X.a..{ */
                        0x19, 0x98, 0xB0, 0xF0, 0xC6, 0x72,
                        0x82, 0xD5, 0x27, 0x06, 0x47, /* .....r..'.G */
                        0x41, 0x22, 0x0F, 0x65, 0x93, 0xC9,
                        0x8A, 0x09, 0x19, 0x48, 0x1B, /* A".e.....H. */
                        0xBD, 0xD6, 0x64, 0x1A, 0xAC, 0xFF,
                        0xF2, 0x42, 0xC0, 0xF1, 0x11, /* ..d....B... */
                        0x25, 0x14, 0x22, 0x06, 0xBC, 0x0E,
                        0xD4, 0x4E, 0x99, 0x90, 0xA8, /* %."....N... */
                        0xD8, 0xB7, 0xAD, 0x5D, 0x3E, 0xAF,
                        0x6E, 0xBE, 0x66, 0x83, 0xA4, /* ...]>.n.f.. */
                        0xE3, 0xC2, 0xE0, 0x29, 0x43, 0x87,
                        0x5F, 0x4F, 0x27, 0x9C, 0x2C, /* ...)C._O'., */
                        0xD0, 0x91, 0xF3, 0x87, 0x9B, 0x54,
                        0xED, 0xD1, 0xB4, 0xF3, 0x39, /* .....T....9 */
                        0x87, 0x22, 0x06, 0x86, 0x0D, 0x71,
                        0xE4, 0x6F, 0x2A, 0x08, 0x04, /* ."...q.o*.. */
                        0xC0, 0x03, 0x2A, 0xB1, 0xE2, 0x05,
                        0x4D, 0x64, 0xA1, 0x9C, 0xA6, /* ..*...Md... */
                        0x0D, 0x41, 0xA6, 0xF2, 0x7A, 0xC1,
                        0x30, 0xC3, 0x38, 0x26, 0x09, /* .A..z.0.8&. */
                        0x50, 0x08, 0xC4, 0xF6, 0x30, 0x0C,
                        0xA6, 0xA9, 0x17, 0x00, 0x13, /* P...0...... */
                        0x0C, 0xDC, 0xC4, 0x2F, 0x28, 0xEB,
                        0x3F, 0xCD, 0x7A, 0x3D, 0x2F, /* .../(.?.z=/ */
                        0xFF, 0xF2, 0x40, 0xC0, 0x18, 0x6F,
                        0x2E, 0x13, 0xA1, 0xF2, 0xBC, /* ..@..o..... */
                        0x36, 0xCB, 0x4E, 0x99, 0x6E, 0xFC,
                        0xEE, 0xC5, 0xF0, 0xA0, 0xB7, /* 6.N.n...... */
                        0x92, 0xD4, 0xEE, 0x79, 0x7C, 0x50,
                        0x5D, 0xE5, 0x04, 0x94, 0xA9, /* ...y|P].... */
                        0x76, 0xCF, 0x6C, 0x70, 0xDD, 0x0D,
                        0xD4, 0xEE, 0xED, 0x98, 0xE8, /* v.lp....... */
                        0xC8, 0x35, 0x36, 0x7A, 0x0C, 0x05,
                        0x80, 0x03, 0xBC, 0xBE, 0x91, /* .56z....... */
                        0x00, 0x7C, 0xAE, 0x65, 0xB8, 0x91,
                        0xA3, 0x33, 0xBA, 0x68, 0x60, /* .|.e...3.h` */
                        0xD4, 0x1A, 0x66, 0xF8, 0x43, 0xA0,
                        0x20, 0x89, 0xE7, 0x80, 0xD8, /* ..f.C. .... */
                        0x1E, 0x4F, 0xA0, 0x04, 0x60, 0x06,
                        0x0A, 0xA4, 0x91, 0x24, 0xFA, /* .O..`....$. */
                        0x9F, 0x57, 0x53, 0xF4, 0x7A, 0xDB,
                        0x5F, 0x56, 0xE3, 0x6E, 0x0B, /* .WS.z._V.n. */
                        0x8B, 0x3A, 0x1C, 0xF9, 0x5E, 0xFF,
                        0xF2, 0x42, 0xC0, 0xB1, 0x00, /* .:..^..B... */
                        0x38, 0x14, 0x09, 0xEE, 0xB4, 0x36,
                        0xD3, 0x4E, 0x99, 0xA4, 0x78, /* 8....6.N..x */
                        0x94, 0x73, 0xC4, 0x66, 0x30, 0xF5,
                        0xEA, 0xDB, 0xBA, 0x67, 0x67, /* .s.f0....gg */
                        0x95, 0x6B, 0xAB, 0x68, 0x5D, 0x08,
                        0xA1, 0x39, 0x56, 0xAB, 0x1E, /* .k.h]..9V.. */
                        0xD5, 0x03, 0xE8, 0x01, 0x70, 0x00,
                        0xB3, 0x93, 0x33, 0x19, 0x8C, /* ....p...3.. */
                        0x61, 0x8F, 0xBB, 0x5D, 0x24, 0x12,
                        0x63, 0xD3, 0x4B, 0x5D, 0x91, /* a..]$.c.K]. */
                        0x08, 0x43, 0x22, 0x56, 0x1A, 0xC5,
                        0x10, 0x21, 0x84, 0xA8, 0xEA, /* .C"V...!... */
                        0x80, 0xBF, 0x16, 0x8E, 0x3D, 0x46,
                        0x18, 0x9C, 0x6E, 0x9A, 0x91, /* ....=F..n.. */
                        0xE6, 0xC9, 0x6F, 0xD2, 0x7D, 0x27,
                        0xD7, 0xE9, 0x6B, 0xFF, 0x0A, /* ..o.}'..k.. */
                        0x03, 0x43, 0x89, 0xD5, 0xBF, 0x52,
                        0x97, 0x0A, 0x25, 0x95, 0x0D, /* .C...R..%.. */
                        0xFF, 0xF2, 0x40, 0xC0, 0xF5, 0xC3,
                        0x41, 0x13, 0x81, 0xEE, 0xA8, /* ..@...A.... */
                        0x5E, 0xD3, 0x44, 0x98, 0xFC, 0xCF,
                        0x97, 0xF9, 0x58, 0xB5, 0x33, /* ^.D.....X.3 */
                        0xB1, 0x85, 0x47, 0x86, 0xD7, 0x98,
                        0x01, 0x3B, 0xA3, 0x4F, 0x7E, /* ..G....;.O~ */
                        0x04, 0xA6, 0xC3, 0x39, 0x21, 0x70,
                        0x27, 0x62, 0xB5, 0x18, 0x10, /* ...9!p'b... */
                        0x09, 0x99, 0x00, 0x8B, 0x7E, 0xF2,
                        0xBF, 0x52, 0x18, 0x26, 0x30, /* ....~..R.&0 */
                        0x1C, 0xB0, 0x01, 0x49, 0x30, 0xE0,
                        0xC3, 0x11, 0x46, 0x05, 0xCC, /* ...I0...F.. */
                        0x49, 0x14, 0x28, 0xB2, 0xED, 0x4B,
                        0x57, 0x5A, 0x2F, 0xB7, 0x46, /* I.(..KWZ/.F */
                        0x63, 0x34, 0xD2, 0xDA, 0x9F, 0x56,
                        0x32, 0xB7, 0xA2, 0x25, 0xFF, /* c4...V2..%. */
                        0x94, 0x28, 0x33, 0x7F, 0x3B, 0xC4,
                        0x50, 0xEC, 0xB1, 0xE2, 0x26, /* .(3.;.P...& */
                        0xA1, 0xB7, 0x07, 0x7F, 0xFB, 0xFF,
                        0xF2, 0x42, 0xC0, 0x67, 0x6A, /* .......B.gj */
                        0x4C, 0x13, 0xF9, 0x6A, 0x90, 0x7E,
                        0xDB, 0x44, 0x94, 0x3F, 0xFF, /* L..j.~.D.?. */
                        0x14, 0xD6, 0x2A, 0xFF, 0xFF, 0xC1,
                        0x34, 0x8C, 0x48, 0x22, 0x00, /* ..*...4.H". */
                        0x06, 0x8F, 0x21, 0xFD, 0x64, 0x60,
                        0x04, 0x92, 0x42, 0xEA, 0x74, /* ..!.d`..B.t */
                        0x32, 0x37, 0xAA, 0x5A, 0x9F, 0x67,
                        0x01, 0x8B, 0x3F, 0x37, 0x31, /* 27.Z.g..?71 */
                        0xDD, 0x06, 0x3C, 0x01, 0x34, 0x30,
                        0xE0, 0x5C, 0x78, 0x78, 0xCB, /* ..<.40.\xx. */
                        0xD6, 0xF1, 0x31, 0x8A, 0x69, 0x61,
                        0x93, 0x92, 0x42, 0xCE, 0x4B, /* ..1.ia..B.K */
                        0xC5, 0x02, 0x4E, 0x73, 0xC6, 0x24,
                        0x30, 0xCD, 0x08, 0x66, 0xC6, /* ..Ns.$0..f. */
                        0x35, 0xAB, 0xA2, 0x3D, 0x2F, 0xB3,
                        0xBD, 0x34, 0x87, 0x13, 0xEE, /* 5..=/..4... */
                        0x71, 0x45, 0x68, 0xFA, 0xEA, 0x05,
                        0x84, 0x41, 0x36, 0x4C, 0x9A, /* qEh....A6L. */
                        0xFF, 0xF2, 0x40, 0xC0, 0xC9, 0x92,
                        0x56, 0x13, 0xD0, 0x6E, 0x70, /* ..@...V..np */
                        0x54, 0xD3, 0xCC, 0x28, 0x06, 0xD7,
                        0x0E, 0xA4, 0x1D, 0x9C, 0x9D, /* T..(....... */
                        0xD9, 0xA9, 0x88, 0x7B, 0xB5, 0xA3,
                        0x56, 0xB7, 0x4B, 0x4B, 0x5A, /* ...{..V.KKZ */
                        0x9B, 0x2C, 0xA9, 0xAD, 0x6F, 0x99,
                        0x6C, 0xC0, 0x4C, 0x14, 0x14, /* .,..o.l.L.. */
                        0xEF, 0xB4, 0x20, 0x91, 0x5F, 0xBC,
                        0x81, 0x41, 0x41, 0x5D, 0xD4, /* .. ._..AA]. */
                        0x20, 0xBD, 0x05, 0x1A, 0x6F, 0xE2,
                        0x68, 0x56, 0x41, 0x41, 0x57, /*  ...o.hVAAW */
                        0xF9, 0xBF, 0x89, 0x82, 0x8E, 0xC7,
                        0x8F, 0x0A, 0x0A, 0x09, 0x37, /* ..........7 */
                        0xF1, 0x05, 0x0A, 0x0A, 0x0A, 0x0A,
                        0x09, 0x05, 0x37, 0xFF, 0x10, /* ........7.. */
                        0x50, 0x50, 0x53, 0x65, 0xFF, 0xFF,
                        0xFD, 0x75, 0xDF, 0xFF, 0xFF, /* PPSe...u... */
                        0x68, 0x4F, 0xFF, 0x84, 0x70, 0xFF,
                        0xF2, 0x42, 0xC0, 0x27, 0x50, /* hO..p..B.'P */
                        0x5F, 0x17, 0xE8, 0x82, 0x3C, 0x11,
                        0x58, 0x18, 0x01, 0x55, 0x48, /* _...<.X..UH */
                        0xBC, 0x52, 0xFC, 0x4A, 0x4C, 0x3C,
                        0xD5, 0xF6, 0x11, 0x2D, 0xBF, /* .R.JL<...-. */
                        0xEA, 0x03, 0x5C, 0x57, 0x29, 0xBF,
                        0xC3, 0x75, 0x1C, 0xE6, 0xDD, /* ..\W)..u... */
                        0xBF, 0xED, 0xEF, 0xD0, 0x98, 0x77,
                        0x71, 0x95, 0x73, 0xFF, 0xED, /* .....wq.s.. */
                        0x54, 0xBE, 0xD5, 0xEE, 0xAE, 0xC2,
                        0xD5, 0x0B, 0xFF, 0xF1, 0x97, /* T.......... */
                        0x8A, 0xE4, 0x42, 0x09, 0x99, 0xB1,
                        0xEA, 0x94, 0xDC, 0x78, 0xB5, /* ..B......x. */
                        0x34, 0x0F, 0xF1, 0x8F, 0xFC, 0x15,
                        0xF6, 0xFA, 0xB1, 0x47, 0xA9, /* 4........G. */
                        0x6C, 0x67, 0x43, 0x8B, 0xF2, 0x76,
                        0x22, 0xED, 0xDA, 0x85, 0xBA, /* lgC..v".... */
                        0x2F, 0xC7, 0xF9, 0xCF, 0xFC, 0xDB,
                        0x46, 0x2E, 0x50, 0x0A, 0x84, /* /.....F.P.. */
                        0xFF, 0xF2, 0x40, 0xC0, 0xC6, 0x4A,
                        0x59, 0x28, 0x2B, 0x19, 0xE0, /* ..@..JY(+.. */
                        0x01, 0x89, 0x78, 0x00, 0x52, 0x85,
                        0x3C, 0x8E, 0x54, 0x9A, 0x48, /* ..x.R.<.T.H */
                        0x5A, 0x72, 0x32, 0x94, 0xBF, 0x43,
                        0x4F, 0x24, 0x53, 0x4B, 0xEC, /* Zr2..CO$SK. */
                        0x4B, 0x99, 0x0E, 0x66, 0x1F, 0xFF,
                        0xCE, 0x7F, 0xFF, 0x3F, 0x10, /* K..f.....?. */
                        0xAE, 0x82, 0x62, 0x71, 0x34, 0x18,
                        0x59, 0x9B, 0x51, 0xC7, 0x59, /* ..bq4.Y.Q.Y */
                        0xCE, 0xEE, 0xA5, 0xFE, 0x02, 0xBB,
                        0x30, 0x91, 0x49, 0xD5, 0x4B, /* ......0.I.K */
                        0xF3, 0xDC, 0x9A, 0xA9, 0x57, 0x8E,
                        0x72, 0x10, 0xC0, 0x5D, 0x60, /* ....W.r..]` */
                        0x67, 0xFC, 0x7D, 0xD6, 0xBA, 0xDD,
                        0xB3, 0x8B, 0x5A, 0x0A, 0x4C, /* g.}.....Z.L */
                        0x41, 0x4D, 0x45, 0x33, 0x2E, 0x39,
                        0x33, 0xAA, 0xAA, 0xAA, 0xAA, /* AME3.93.... */
                        0xAA, 0xAA, 0xAA, 0xAA, 0xAA, 0x54,
                        0x41, 0x47, 0x48, 0x65, 0x6C, /* .....TAGHel */
                        0x6C, 0x6F, 0x20, 0x20, 0x20, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /* lo          */
                        0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /*             */
                        0x20, 0x20, 0x20, 0x20, 0x20, 0x50,
                        0x61, 0x6E, 0x75, 0x2D, 0x4B, /*      Panu-K */
                        0x72, 0x69, 0x73, 0x74, 0x69, 0x61,
                        0x6E, 0x20, 0x50, 0x6F, 0x69, /* ristian Poi */
                        0x6B, 0x73, 0x61, 0x6C, 0x6F, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /* ksalo       */
                        0x20, 0x20, 0x56, 0x53, 0x44, 0x53,
                        0x50, 0x20, 0x54, 0x65, 0x73, /*   VSDSP Tes */
                        0x74, 0x69, 0x6E, 0x67, 0x20, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /* ting        */
                        0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /*             */
                        0x20, 0x20, 0x20, 0x4D, 0x50, 0x33,
                        0x20, 0x48, 0x65, 0x6C, 0x6C, /*    MP3 Hell */
                        0x6F, 0x2C, 0x20, 0x57, 0x6F, 0x72,
                        0x6C, 0x64, 0x21, 0x20, 0x20, /* o, World!   */
                        0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
                        0x20, 0x20, 0x20, 0x20, 0x20, /*             */
                        0x00};
typedef char songname[32];
const int length_512 = 512;
QueueHandle_t Q_songname;
QueueHandle_t Q_songdata;
QueueHandle_t Q_filename;

app_cli_status_e cli__mp3_play(app_cli__argument_t argument, sl_string_t user_input_minus_command_name,
                                   app_cli__print_string_function cli_output) {
  // sl_string is a powerful string library, and you can utilize the sl_string.h API to parse parameters of a command
  
  sl_string_t s = user_input_minus_command_name;

  songname name;
  // for(int i=0; i<32;i++){
  //   if(s[i] == '\0')
  //     break;
  //   *name = sl_string__c_str(&s);
  // }

  // sl_string__printf(s, "\n");
  int c=0;
  while(c<32-5){
    if(s[c]=='.'){
      break;
    }
    // sl_string__append_char(s, s[c]);
    name[c] = sl_string__c_str(s[c]);
    c++;
  }
  for(int i=0;i<4;i++){
    name[c] = sl_string__c_str(s[c]);
    c++;
  }
  name[c] = '\0';
  // cli_output(NULL, s);

  // printf("\nsize: %d\nname: %s\ns: %s\nname 1 : %c\nname 2 : %c\n", sl_string__get_length(s), name, s, name[0], name[1]);
  xQueueSend(Q_songname, &name, portMAX_DELAY);

  // printf("Sent %s over to the Q_songname\n", user_input_minus_command_name);
  return APP_CLI_STATUS__SUCCESS;
}

// Reader tasks receives song-name over Q_songname to start reading it
void mp3_reader_task(void *p) {
  songname name;
  char bytes_512[length_512];
  FIL file; // File handle
  UINT byte_read = 0;
  int file_size;
  int byte_been_read;
  while(1) {
    xQueueReceive(Q_songname, &name, portMAX_DELAY);
    printf("Received song to play: %s\n", name);

    const char *filename = name;
    FRESULT result = f_open(&file, filename, FA_READ); //open_file();

    if (FR_OK == result) {
      file_size = f_size(&file);
      printf("file_size: %u\n", file_size);
      byte_been_read = 0;
      while(byte_been_read<file_size){
        f_read(&file, &bytes_512, length_512, &byte_read);
        xQueueSend(Q_songdata, &bytes_512, portMAX_DELAY);
        byte_been_read += byte_read;
        // if(byte_read<length_512){
        //   bytes_512[byte_read] = '\0';
        //   xQueueSend(Q_songdata, &bytes_512, portMAX_DELAY);
        //   break;
        // }else{
        //   xQueueSend(Q_songdata, &bytes_512, portMAX_DELAY);
        // }
        // if((byte_been_read % (1000)) == 0)
        //   printf("byte_been_read: %d\n", byte_been_read);
      }
      f_close(&file);
      printf("\nend of file. \n");
      printf("from reader: size %d real_size %d\n", file_size, byte_been_read);
    }else{
      printf("ERROR: Failed to open: %s\n", filename);
    }
    // vTaskDelay(10);
  }
}
bool mp3_dreq_getLevel(void){
  return ((LPC_GPIO0->PIN >> 8) & 1);
}
bool mp3_decoder_needs_data(void){
  return mp3_dreq_getLevel();
}
void spi_send_to_mp3_decoder(uint8_t byte){
  // ---------------------------------------------------------------------------------------------------------------------
  dec_dcs();
  ssp0__exchange_byte_lab(byte);
  // while (!mp3_dreq_getLevel())
  //   ;
  // while (!mp3_dreq_getLevel())
  //   ;
  dec_dds();
}
// Player task receives song data over Q_songdata to send it to the MP3 decoder
void mp3_player_task(void *p) {
  char bytes_512[length_512];
  // int size;
  while (1) {
    // vTaskDelay(1000);
    // printf("\n");
    xQueueReceive(Q_songdata, &bytes_512, portMAX_DELAY);
    // size=0;
    dec_dcs();
    vTaskDelay(6);
    for (int i = 0; i < sizeof(bytes_512); i+=32) {
      while (!mp3_decoder_needs_data()) {
        vTaskDelay(5);
      }
      for(int j=0;j<32;j++){
        ssp0__exchange_byte_lab(bytes_512[i+j]);
        // printf("0x%x, ", bytes_512[i+j]);
      }
      while (!mp3_decoder_needs_data()) {
        vTaskDelay(5);
      }
    }
    // size+=512;
    dec_dds();
    // printf("from sender: %d\n", size);
    // vTaskDelay(10);
    // printf("\n");
  }
}

// void sd_read(void){
//   DIR dp;
//   FRESULT result = f_opendir(&dp, NULL);
// }

FRESULT scan_files (
    char* path        /* Start node to be scanned (***also used as work area***) */
)
{
    FRESULT res;
    DIR dir;
    UINT i;
    static FILINFO fno;

    res = f_opendir(&dir, path);                       /* Open the directory */
    if (res == FR_OK) {
        for (;;) {
            res = f_readdir(&dir, &fno);                   /* Read a directory item */
            if (res != FR_OK || fno.fname[0] == 0) break;  /* Break on error or end of dir */
            if (fno.fattrib & AM_DIR) {                    /* It is a directory */
                i = strlen(path);
                sprintf(&path[i], "/%s", fno.fname);
                res = scan_files(path);                     /* Enter the directory */
                if (res != FR_OK) break;
                path[i] = 0;
            } else {                                       /* It is a file. */
                printf("%s/%s\n", path, fno.fname);

                // find mp3
                if(fno.fname[strlen(fno.fname)-1]=='3'){
                  int i=0;
                  while(fno.fname[i]!='\0'){
                    printf("%c", fno.fname[i]);
                    i++;
                  }
                  printf("\n");
                  // send to task(fno.fname)
                  xQueueSend(Q_filename, &fno.fname, portMAX_DELAY);
                }
            }
        }
        f_closedir(&dir);
    }

    return res;
}

int length_of_name(songname *name){
  int i=0;
  while(i<32){
    if(name[i]=='\0')
      return i;
  }
  return i;
}

void mp3_file_display_task(void *p){
  int page = 2;
  songname name;

  while(1){
    xQueueReceive(Q_filename, &name, portMAX_DELAY);
    if(length_of_name(name)<17)
      lcd_print_string_8x8(page, name);
    else{
      lcd_print_string_8x8(page, name);
      name[14]=' ';
      name[15]=' ';
      lcd_print_string_8x8(page+1, name[14]);
    }
    if(page>6){
      page=2;
    }else{
      page++;
    }
    vTaskDelay(1000);
  }
}

int mp3_file_display(void)
{
    FATFS fs;
    FRESULT res;
    char buff[256];

    res = f_mount(&fs, "", 1);
    if (res == FR_OK) {
        strcpy(buff, "/");
        res = scan_files(buff);
    }

    return res;
}

void test(void *p){
  while(1){
    mp3_file_display();
    vTaskDelay(1000000);
  }
}
//-----------------------------------------------------------------------------------------------------------------------------------------------------
uint16_t MODE = 0x4810; // 4800
uint16_t CLOCKF = 0xE000; //was 9800, EBE8, B3E8, BBE8
volatile uint16_t VOL = 0x2222; //full vol
uint16_t BASS = 0x0076; //was 00F6
uint16_t AUDATA = 0xAC80; //for stereo decoding, AC45,AC80, BB80-check
uint16_t STATUS;
//VS10xx SCI Registers
#define SCI_MODE 0x00
#define SCI_STATUS 0x01
#define SCI_BASS 0x02
#define SCI_CLOCKF 0x03
#define SCI_DECODE_TIME 0x04
#define SCI_AUDATA 0x05
#define SCI_WRAM 0x06
#define SCI_WRAMADDR 0x07
#define SCI_HDAT0 0x08
#define SCI_HDAT1 0x09
#define SCI_AIADDR 0x0A
#define SCI_VOL 0x0B
#define SCI_AICTRL0 0x0C
#define SCI_AICTRL1 0x0D
#define SCI_AICTRL2 0x0E
#define SCI_AICTRL3 0x0F
#define playSpeed 0x1e04

//commands
#define READ 0x03
#define WRITE 0x02

//static uint8_t SEND_NUM_BYTES = 32;
static uint16_t READ_BYTES_FROM_FILE = 4096;
static uint16_t TRANSMIT_BYTES_TO_DECODER = 32;

void mp3_writeRequest(uint8_t address, uint16_t data)
{
  while (!mp3_dreq_getLevel())
    ;
  dec_cs(); //do a chip select
  ssp0__exchange_byte_lab(WRITE);
  ssp0__exchange_byte_lab(address);
  uint8_t dataUpper = (data >> 8 & 0xFF);
  uint8_t dataLower = (data & 0xFF);
  ssp0__exchange_byte_lab(dataUpper);
  ssp0__exchange_byte_lab(dataLower);
  while (!mp3_dreq_getLevel())
    ; // dreq should go high indicating transfer complete
  dec_ds(); // Assert a HIGH signal to de-assert the CS
}
bool mp3_initDecoder()
{
  mp3_writeRequest(SCI_MODE, MODE);
  mp3_writeRequest(SCI_CLOCKF, CLOCKF);
  // mp3_writeRequest(SCI_VOL, VOL);
  // mp3_writeRequest(SCI_BASS, BASS);
  // mp3_writeRequest(SCI_AUDATA, AUDATA);

  // mp3_writeRequest(SCI_AICTRL0, 0x7000);
  // mp3_writeRequest(SCI_AICTRL1, 0x7000);
  // mp3_writeRequest(SCI_AIADDR, 0x4020);
  return true;
}




void dec_cs(void){
  LPC_IOCON->P0_6 &= ~(7<<0);
  LPC_GPIO0->DIR |= (1<<6);
  LPC_GPIO0->CLR |= (1<<6);
}
void dec_ds(void){
  LPC_IOCON->P0_6 &= ~(7<<0);
  LPC_GPIO0->DIR |= (1<<6);
  LPC_GPIO0->SET |= (1<<6);
}
void dec_dcs(void){
  LPC_IOCON->P0_7 &= ~(7<<0);
  LPC_GPIO0->DIR |= (1<<7);
  LPC_GPIO0->CLR |= (1<<7);
}
void dec_dds(void){
  LPC_IOCON->P0_7 &= ~(7<<0);
  LPC_GPIO0->DIR |= (1<<7);
  LPC_GPIO0->SET |= (1<<7);
}
void dec_rst(void){
  LPC_IOCON->P0_9 &= ~(7<<0);
  LPC_GPIO0->DIR |= (1<<9);
  LPC_GPIO0->CLR |= (1<<9);
  vTaskDelay(100);
  LPC_GPIO0->SET |= (1<<9);
  vTaskDelay(100);
}
void dec_dreq_set_as_input(void){
  LPC_IOCON->P0_8 &= ~(0x7<<0);
  LPC_GPIO0->DIR &= ~(1<<8);
}
void spi_ds_1_10(void){
  LPC_IOCON->P1_10 &= ~(7<<0);
  LPC_GPIO1->DIR |= (1<<10);
  LPC_GPIO1->SET |= (1<<10);
}
void dec_init(){
  spi_ds_1_10();

  dec_dreq_set_as_input();
  dec_ds();
  dec_dds();

  vTaskDelay(100);
  dec_rst();

  vTaskDelay(100);
  mp3_initDecoder();
  vTaskDelay(100);
}
typedef struct {
  uint8_t first_byte;
  uint8_t second_byte;
  uint8_t third_byte;
  uint8_t forth_byte;
} mp3_dec;
mp3_dec mp3_dec_read(uint8_t first, uint8_t second, uint8_t third, uint8_t forth) {
  mp3_dec data = { 1, 2, 3, 4 };
  
  dec_cs();
  {
    // Send opcode and read bytes
    // TODO: Populate members of the 'adesto_flash_id_s' struct
    // ssp0__exchange_byte_lab(0x03);
    data.first_byte = ssp0__exchange_byte_lab(first);
    data.second_byte = ssp0__exchange_byte_lab(second);
    data.third_byte = ssp0__exchange_byte_lab(third);
    data.forth_byte = ssp0__exchange_byte_lab(forth);
  }
  dec_ds();

  return data;
}

mp3_dec mp3_dec_d_write(uint8_t first, uint8_t second, uint8_t third, uint8_t forth) {
  dec_dcs();
  {
    ssp0__exchange_byte_lab(first);
    ssp0__exchange_byte_lab(second);
    ssp0__exchange_byte_lab(third);
    ssp0__exchange_byte_lab(forth);
    ssp0__exchange_byte_lab(0);
    ssp0__exchange_byte_lab(0);
    ssp0__exchange_byte_lab(0);
    ssp0__exchange_byte_lab(0);
  }
  dec_dds();
}

// typedef struct {
//     uint8_t manufacturer_id;
//     uint8_t device_id_1;
//     uint8_t device_id_2;
//     uint8_t extended_device_id;
// } adesto_flash_id_s;
// adesto_flash_id_s ssp0__adesto_read_signature(void) {
//     adesto_flash_id_s data = { 0 };
    
//     adesto_cs();
//     {
//         // Send opcode and read bytes
//         // TODO: Populate members of the 'adesto_flash_id_s' struct
//         ssp0__exchange_byte_lab(0x9F);
//         data.manufacturer_id = ssp0__exchange_byte_lab(0xFF);
//         data.device_id_1 = ssp0__exchange_byte_lab(0xFF);
//         data.device_id_2 = ssp0__exchange_byte_lab(0xFF);
//         data.extended_device_id = ssp0__exchange_byte_lab(0xFF);
//     }
//     adesto_ds();

//     return data;
// }
//-----------------------------------------------------------------------------------------------------------------------------------------------------

// SemaphoreHandle_t sw_8_signal;

// static void GPIO_IRQ_lab(void) {
//   gpio0__interrupt_dispatcher();
// }
// void pin8_isr(void) {
//   xSemaphoreGiveFromISR(sw_8_signal, NULL);
// }
// void task_8(void *pvParameters){
//   while(1){
//     if (xSemaphoreTake(sw_8_signal, portMAX_DELAY - 1)){
//         printf("%d\n", 1);
//         vTaskDelay(100);
//     }
//   }
// }
void task_dreq(void *pvParameters){
  uint32_t i=0;
  while(1){
    i = (LPC_GPIO0->PIN>>8) & 1;
    printf("dreq: %u\n", i);
    vTaskDelay(100);
  }
}
void task_spi(void *pvParameters){
  mp3_dec id={0x01, 0x02, 0x03, 0x04};
  vTaskDelay(1000);
  dec_init();
  vTaskDelay(100);
  // mp3_dec_d_write(0x53, 0xEF, 0x6E, 0x7E);
  // mp3_dec_d_write(0, 0, 0, 0);
  for(uint8_t i=0; i<16;i++){
    id=mp3_dec_read(0x03, i, 0x12, 0x34);
    printf("dec_write: %x, %x, %x, %x\n", id.first_byte, id.second_byte, id.third_byte, id.forth_byte);
    vTaskDelay(100);
  }
  int i=0;
  while(1){
    vTaskDelay(500000);
    // printf("%d\n", i);
    // ++i;
  }
}
void task_hello(void *pvParameters){
  vTaskDelay(2000);
  dec_init();
  vTaskDelay(100);
  while(1){
    dec_dcs();
    int i=0;
    printf("\nsize of sound_test: %d\n", sizeof(sound_test));
    while(i<sizeof(sound_test)){
      ssp0__exchange_byte_lab(sound_test[i]);
      ++i;
    }
    dec_dds();
    vTaskDelay(1000);
  }
}
int main(void) {
  sj2_cli__init();

  Q_songname = xQueueCreate(1, 32); //(sizeof(songname), 1)
  Q_songdata = xQueueCreate(1, length_512);
  Q_filename = xQueueCreate(1, 32);

  ssp0__init_lab(1);

  // LPC_IOCON->P0_8 &= ~(0x1F<<0);
  // LPC_IOCON->P0_8 |= (0x10<<0);
  // LPC_GPIO0->DIR &= ~(1<<8);
  // sw_8_signal = xSemaphoreCreateBinary();
  // NVIC_EnableIRQ(GPIO_IRQn);
  // lpc_peripheral__enable_interrupt(LPC_PERIPHERAL__GPIO, GPIO_IRQ_lab);
  // gpio0__attach_interrupt(8, GPIO_INTR__FALLING_EDGE, pin8_isr);

  // lcd_init();
  // lcd_clear();
  // lcd_font_init();

  // lcd_font_printf();
  // lcd_print_char(1, 1, 1, 0);

  // lcd_page_mode();
  // lcd_pic();
  // lcd_test();

  // func();
  // lcd_print_string(3, "0000");
  // lcd_print_string_8x8(3, "qwerty");
  // lcd_print_string_8x8(1, "1234567890");

  // xTaskCreate(task_8, "8", (512U * 8 / sizeof(void *)), NULL, PRIORITY_LOW, NULL);
  xTaskCreate(task_spi, "dec_spi", (512U * 8 / sizeof(void *)), NULL, PRIORITY_HIGH, NULL);
  // xTaskCreate(task_dreq, "dreq", (512U * 8 / sizeof(void *)), NULL, PRIORITY_LOW, NULL);
  // xTaskCreate(task_hello, "hello", (512U * 8 / sizeof(void *)), NULL, PRIORITY_HIGH, NULL);

  // mp3
  xTaskCreate(mp3_reader_task, "reader", (512U * 8 / sizeof(void *)), NULL, PRIORITY_LOW, NULL);
  xTaskCreate(mp3_player_task, "player", (512U * 8 / sizeof(void *)), NULL, PRIORITY_MEDIUM, NULL);

  // lcd
  // xTaskCreate(mp3_file_display_task, "file", (512U * 8 / sizeof(void *)), NULL, PRIORITY_HIGH, NULL);
  // xTaskCreate(test, "test", (512U * 8 / sizeof(void *)), NULL, PRIORITY_HIGH, NULL);

  //(512U * 8 / sizeof(void *))
  //configMINIMAL_STACK_SIZE

  puts("Starting RTOS");
  vTaskStartScheduler(); // This function never returns unless RTOS scheduler runs out of memory and fails

  return 0;
}
